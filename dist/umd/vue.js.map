{"version":3,"file":"vue.js","sources":["../../src/observer/array.js","../../src/observer/index.js","../../src/state.js","../../src/compiler/parse.js","../../src/compiler/generate.js","../../src/compiler/index.js","../../src/vdom/patch.js","../../src/lifecycle.js","../../src/init.js","../../src/vdom/index.js","../../src/index.js"],"sourcesContent":["// 数组原型上的方法(原来的方法)\r\nlet oldArrayProtoMethods = Array.prototype;\r\n\r\n// 继承 __proto__\r\nexport let arrayMethods = Object.create(oldArrayProtoMethods);\r\n\r\nlet methods = [\r\n    'push',\r\n    'pop',\r\n    'shift',\r\n    'unshift',\r\n    'reverse',\r\n    'sort',\r\n    'splice'\r\n]\r\n\r\nmethods.forEach(method => {\r\n    arrayMethods[method] = function(...args) {\r\n        let result = oldArrayProtoMethods[method].apply(this, args);\r\n        let inserted;\r\n        let ob = this.__ob__;\r\n        switch (method) {\r\n            case 'push': //arr.push({a: 1}, {b: 2})\r\n            case 'unshift': //这两个方法都是追加，追加的内容可能是对象类型,应该再次进行劫持\r\n                inserted = args;\r\n                break;\r\n            case 'splice': //Vue.$set原理\r\n                inserted = args.slice(2); //arr.splice(0, 1, {a: 1})\r\n            default:\r\n                break;\r\n        }\r\n        if (inserted) ob.observeArray(inserted);\r\n        return result;\r\n    }\r\n})","import { arrayMethods } from './array.js';\r\n\r\nclass Observer{\r\n    constructor(value) {\r\n        // 使用defineProperty重新定义熟悉，区分数组\r\n        \r\n        // 判断一个对象是否被观测 __ob__\r\n        Object.defineProperty(value, '__ob__', {\r\n            enumerable: false, //不可枚举\r\n            configurable: false,\r\n            value: this\r\n        })\r\n        if (Array.isArray(value)) {\r\n            // 调用push,shift,unshift,sort,reverse pop\r\n            // 函数劫持，切片编程\r\n            value.__proto__ = arrayMethods;\r\n            // 观测数组中的对象类型，对象变化也要监测\r\n            this.observeArray(value);\r\n        } else {\r\n            this.walk(value);\r\n        }\r\n    }\r\n    observeArray (value) {\r\n        value.forEach(item => {\r\n            observe(item); //观测数组中的对象类型\r\n        })\r\n    }\r\n    walk(data) {\r\n        let keys = Object.keys(data);\r\n        keys.forEach(key => {\r\n            defineReactive(data, key, data[key]);\r\n        });\r\n    }\r\n}\r\n\r\nfunction defineReactive(data, key, value) {\r\n    observe(value); //如果值是对象继续监测\r\n    Object.defineProperty(data, key, {\r\n        get () {\r\n            return value;\r\n        },\r\n        set (newValue) {\r\n            if (newValue == value) return;\r\n            observe(newValue); //如果用户将值设置为对象继续监测\r\n            value = newValue;\r\n        }\r\n    })\r\n}\r\n\r\nexport function observe (data) {\r\n    // data不能是非对象或者为null\r\n    if (typeof data !== 'object' || data === null) {\r\n        return data;\r\n    }\r\n    if (data.__ob__) {\r\n        return data;\r\n    }\r\n    return new Observer(data);\r\n}","import { observe } from \"./observer/index\";\r\n\r\nexport function initState (vm) {\r\n    const opts = vm.$options;\r\n    if (opts.props) {\r\n        initProps(vm);\r\n    }\r\n    if (opts.methods) {\r\n        initMethods(vm);\r\n    }\r\n    if (opts.data) {\r\n        initData(vm);\r\n    }\r\n    if (opts.computed) {\r\n        initComputed(vm);\r\n    }\r\n    if (opts.watch) {\r\n        initWatch(vm);\r\n    }\r\n}\r\nfunction initProps() {}\r\nfunction initMethods() {}\r\nfunction proxy (vm, data, key) {\r\n    Object.defineProperty(vm, key, {\r\n        get () {\r\n            return vm[data][key];\r\n        },\r\n        set (newValue) {\r\n            vm[data][key] = newValue;\r\n        }\r\n    })\r\n}\r\nfunction initData(vm) { //数据的初始化操作\r\n    let data = vm.$options.data;\r\n    vm._data = data = typeof data == 'function' ? data.call(this) : data;\r\n\r\n    // 数据的劫持方案 对象Object,defineProperty\r\n    // 数组 单独处理\r\n    // 当在vm取属性时，将值代理到vm._data上\r\n    for (let key in data) {\r\n        proxy(vm, '_data', key);\r\n    }\r\n\r\n    observe(data);\r\n}\r\nfunction initComputed() {}\r\nfunction initWatch() {}","const ncname = `[a-zA-Z_][\\\\-\\\\.0-9_a-zA-Z]*`; //标签名 \r\n// ?:匹配不捕获\r\nconst qnameCapture = `((?:${ncname}\\\\:)?${ncname})`; //my:xx命名空间\r\nconst startTagOpen = new RegExp(`^<${qnameCapture}`); //标签开头的正则表达式 <name\r\nconst endTag = new RegExp(`^<\\\\/${qnameCapture}[^>]*>`); //匹配标签结尾 </div>\r\n// 匹配属性 aaa=\"aaa\" a='aa' a=aaa\r\nconst attribute = /^\\s*([^\\s\"'<>\\/=]+)(?:\\s*(=)\\s*(?:\"([^\"]*)\"+|'([^']*)'+|([^\\s\"'=<>`])))/;\r\nconst startTagClose = /^\\s*(\\/?)>/; //匹配标签结束的 /> >\r\nconst defaultTagRE = /\\{\\{((?:.|\\r?\\n)+?)\\}\\}/g; //{{sd}}\r\n\r\nexport function parseHTML(html) {\r\n    // 数据结构 树，栈，链表，队列\r\n    function createASTElement(tagName, attrs) {\r\n        return {\r\n            tag: tagName,\r\n            type: 1,\r\n            children: [],\r\n            attrs,\r\n            parent: null\r\n        }\r\n    }\r\n    let root;\r\n    let currentParent;\r\n    let stack = [];\r\n    // 检测标签是否符合预期 <div>123<span><p></p></span></div> [div, span, p]\r\n    function start(tagName, attrs) {\r\n        let element = createASTElement(tagName, attrs);\r\n        if (!root) {\r\n            root = element;\r\n        }\r\n        currentParent = element;\r\n        stack.push(element);\r\n    }\r\n\r\n    function end(tagName) { //创建父子关系\r\n        let element = stack.pop(); //取出栈中最后一个\r\n        currentParent = stack[stack.length - 1];\r\n        if (currentParent) {\r\n            element.parent = currentParent;\r\n            currentParent.children.push(element);\r\n        }\r\n    }\r\n\r\n    function chars(text) {\r\n        text = text.trim();\r\n        if (text) {\r\n            currentParent.children.push({\r\n                type: 3,\r\n                text\r\n            })\r\n        }\r\n    }\r\n    while (html) { //只要html不为空字符串\r\n        let textEnd = html.indexOf('<');\r\n        if (textEnd == 0) {\r\n            // 肯定是标签\r\n            let startTagMatch = parseStartTag();\r\n            if (startTagMatch) {\r\n                start(startTagMatch.tagName, startTagMatch.attrs);\r\n                continue;\r\n            }\r\n        }\r\n        const endTagMatch = html.match(endTag);\r\n        if (endTagMatch) {\r\n            advance(endTagMatch[0].length);\r\n            end(endTagMatch[1]);\r\n            continue;\r\n        }\r\n        let text;\r\n        if (textEnd > 0) { //是文本\r\n            text = html.substring(0, textEnd);\r\n        }\r\n        if (text) {\r\n            advance(text.length);\r\n            chars(text);\r\n        }\r\n    }\r\n    function advance(n) { //字符串截取\r\n        html = html.substring(n);\r\n    }\r\n    function parseStartTag() {\r\n        const start = html.match(startTagOpen);\r\n        if (start) {\r\n            const match = {\r\n                tagName: start[1],\r\n                attrs: []\r\n            }\r\n            advance(start[0].length); //删除开始标签 \r\n            let end;\r\n            let attr;\r\n            // 不是结尾标签 能匹配到属性\r\n            while (!(end = html.match(startTagClose)) && (attr = html.match(attribute))) {\r\n                match.attrs.push({\r\n                    name: attr[1],\r\n                    value: attr[3] || attr[4] || attr[5] //3种情况\r\n                });\r\n                advance(attr[0].length); //去掉当前属性\r\n            }\r\n            if (end) {\r\n                advance(end[0].length);\r\n                return match;\r\n            }\r\n        }\r\n    }\r\n    return root;\r\n}","const defaultTagRE = /\\{\\{((?:.|\\r?\\n)+?)\\}\\}/g; //{{sd}}\r\n\r\nfunction genProps(attrs) {\r\n    // id \"app\" / style \"fontSize:12px;color:red\"\r\n    let str = '';\r\n    for (let i = 0; i < attrs.length; i++) {\r\n        let attr = attrs[i];\r\n        if (attr.name === 'style') {\r\n            let obj = {};\r\n            attr.value.split(';').forEach(item => {\r\n                let [key, value] = item.split(\":\");\r\n                obj[key] = value;\r\n            });\r\n            attr.value = obj;\r\n        }\r\n        str += `${attr.name}:${JSON.stringify(attr.value)},`;\r\n    }\r\n    return `{${str.slice(0, -1)}}`\r\n}\r\n\r\nfunction gen(node) {\r\n    if (node.type == 1) {\r\n        return generate(node); //节点\r\n    } else {\r\n        let text = node.text;\r\n\r\n        let tokens = []; //存放每一段的代码\r\n        let lastIndex = defaultTagRE.lastIndex = 0; //正则表达式是全局的，必须每次重置为0\r\n        let match,index; //每次匹配到的结果\r\n\r\n        while(match = defaultTagRE.exec(text)) {\r\n            index = match.index; //保存匹配到的索引\r\n            if (index > lastIndex) {\r\n                tokens.push(JSON.stringify(text.slice(lastIndex, index)))\r\n            }\r\n            tokens.push(`_s(${match[1].trim()})`);\r\n            lastIndex = index + match[0].length;\r\n        }\r\n        if (lastIndex < text.length) {\r\n            tokens.push(JSON.stringify(text.slice(lastIndex)));\r\n        }\r\n        return `_v(${tokens.join('+')})`;\r\n    }\r\n}\r\n\r\nfunction genChildren(el) {\r\n    const children = el.children;\r\n    if (children) {\r\n        return children.map(child => gen(child)).join(',');\r\n    }\r\n}\r\n\r\nexport function generate(el) {\r\n    let children = genChildren(el);\r\n    let code = `_c('${el.tag}',${\r\n        el.attrs.length ? `${genProps(el.attrs)}` : 'undefined'\r\n    }${\r\n        children?`,${children}`:''\r\n    })`;\r\n\r\n    return code;\r\n}","import { parseHTML } from \"./parse.js\";\r\nimport { generate } from './generate.js';\r\n\r\nexport function compileToFunctions(template) {\r\n    // html模板 => render函数\r\n    // 1.需要将html代码转为 AST语法树，可以用AST语法树来描述语音本身(虚拟DOM是用对象来描述节点的)\r\n\r\n    // 前端必须掌握的数据结构(树)\r\n    let ast = parseHTML(template);\r\n    // 2.优化静态节点\r\n\r\n    // 3.通过这颗树，重新生成代码\r\n    // <div id=\"app\" style=\"color: red;\">\r\n    // hello{{name}}\r\n    // <span>hello</span>\r\n    // </div>\r\n    // render () {\r\n    // return _c('div', {\r\n    //     id: 'app',\r\n    //     style: {\r\n    //         color: 'red'\r\n    //     }\r\n    // }, _v('hello' + _s(name)), _c('span', null, _v('hello')))\r\n    // }\r\n    let code = generate(ast);\r\n    // 4.将字符串生成函数 限制取值范围 通过with来取值\r\n    let render = new Function(`with(this){return ${code}}`);\r\n    \r\n    return render;\r\n}","export function patch(old, vnode) {\r\n\r\n    let el = createEle(vnode);\r\n    let parentElm = old.parentNode;\r\n    parentElm.insertBefore(el, old.nextSibling);\r\n    parentElm.removeChild(old);\r\n}\r\n\r\nfunction createEle(vnode) {\r\n    let {tag, children, key, data, text} = vnode;\r\n    if (typeof tag === 'string') {\r\n        vnode.el = document.createElement(tag);\r\n        children.forEach(child => {\r\n            vnode.el.appendChild(createEle(child));\r\n        })\r\n    } else {\r\n        vnode.el = document.createTextNode(text);\r\n    }\r\n    return vnode.el;\r\n}","import { patch } from './vdom/patch.js';\r\n\r\nexport function lifecycleMixin(Vue) {\r\n    Vue.prototype._update = function (vnode) {\r\n        const vm = this;\r\n        patch(vm.$el, vnode);\r\n    }\r\n}\r\n\r\nexport function mountComponent(vm, el) {\r\n    // 调用render方法去渲染\r\n\r\n    // 先调用render方法创建虚拟节点，再将虚拟节点渲染到页面\r\n    vm._update(vm._render());\r\n}","import { initState } from \"./state.js\";\r\nimport { compileToFunctions } from './compiler/index';\r\nimport { mountComponent } from './lifecycle.js';\r\n\r\nexport function initMixin(Vue) {\r\n    Vue.prototype._init = function (options) {\r\n        const vm = this;\r\n        vm.$options = options;\r\n        // 数据做劫持\r\n        // vue组件很多状态 data props watch\r\n        initState(vm);\r\n        // vue的核心特性 响应式数据原理\r\n        // Vue是一个什么样的框架，不是MVVM框架，是借鉴MVVM框架\r\n        // 数据变化视图会更新，视图变化数据会被影响\r\n        // (MVVM)是指不能跳过数据去更新视图,但是vue有类似$ref直接去修改视图内容\r\n\r\n        // 如果当前有el属性说明要渲染模板\r\n        if (vm.$options.el) {\r\n            vm.$mount(vm.$options.el)\r\n        }\r\n    }\r\n    Vue.prototype.$mount = function(el) {\r\n        // 挂载操作\r\n        const vm = this;\r\n        const options = vm.$options;\r\n        el = document.querySelector(el);\r\n        vm.$el = el;\r\n\r\n        if (!options.render) {\r\n            let template = options.template;\r\n            if (!template && el) {\r\n                template = el.outerHTML;\r\n            }\r\n            // 编译原理，将模板编译成render\r\n            const render = compileToFunctions(template);\r\n            options.render = render;\r\n        }\r\n        mountComponent(vm, el);\r\n    }\r\n}","export function renderMixin(Vue) {\r\n    Vue.prototype._c = function () { //创建元素\r\n        return createElement(...arguments);\r\n    }\r\n    Vue.prototype._s = function (val) {\r\n        return val == null ? '' :(typeof val == 'object') ? JSON.stringify(val) : val;\r\n    }\r\n    Vue.prototype._v = function (text) { //创建文本元素\r\n        return createTextVnode(text);\r\n    }\r\n    Vue.prototype._render = function () {\r\n        const vm = this;\r\n        const render = vm.$options.render;\r\n        let vnode = render.call(vm);\r\n        console.log(render)\r\n        console.log(vnode)\r\n        return vnode;\r\n    }\r\n}\r\n\r\nfunction createElement(tag, data = {}, ...children) {\r\n    return vnode(tag, data, data.key, children);\r\n}\r\n\r\nfunction createTextVnode(text) {\r\n    return vnode(undefined, undefined, undefined, undefined, text);\r\n}\r\n\r\nfunction vnode(tag, data, key, children, text) {\r\n    return {\r\n        tag,\r\n        data,\r\n        key,\r\n        children,\r\n        text\r\n    }\r\n}","import {initMixin} from './init.js';\r\nimport { lifecycleMixin } from './lifecycle.js';\r\nimport { renderMixin } from './vdom/index.js';\r\n\r\nfunction Vue(options) {\r\n    this._init(options); //入口方法，初始化操作\r\n}\r\n\r\n//写成插件进行扩展\r\ninitMixin(Vue);\r\nlifecycleMixin(Vue);\r\nrenderMixin(Vue);\r\n\r\nexport default Vue;"],"names":["oldArrayProtoMethods","Array","prototype","arrayMethods","Object","create","methods","forEach","method","args","result","apply","inserted","ob","__ob__","slice","observeArray","Observer","value","defineProperty","enumerable","configurable","isArray","__proto__","walk","item","observe","data","keys","key","defineReactive","get","set","newValue","initState","vm","opts","$options","props","initData","computed","watch","proxy","_data","call","ncname","qnameCapture","startTagOpen","RegExp","endTag","attribute","startTagClose","parseHTML","html","createASTElement","tagName","attrs","tag","type","children","parent","root","currentParent","stack","start","element","push","end","pop","length","chars","text","trim","textEnd","indexOf","startTagMatch","parseStartTag","endTagMatch","match","advance","substring","n","attr","name","defaultTagRE","genProps","str","i","obj","split","JSON","stringify","gen","node","generate","tokens","lastIndex","index","exec","join","genChildren","el","map","child","code","compileToFunctions","template","ast","render","Function","patch","old","vnode","createEle","parentElm","parentNode","insertBefore","nextSibling","removeChild","document","createElement","appendChild","createTextNode","lifecycleMixin","Vue","_update","$el","mountComponent","_render","initMixin","_init","options","$mount","querySelector","outerHTML","renderMixin","_c","arguments","_s","val","_v","createTextVnode","console","log","undefined"],"mappings":"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"}